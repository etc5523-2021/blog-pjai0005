---
title: "Peru"
description: |
  COVID-19 crisis in Peru.
date: "`r Sys.Date()`"
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

```

```{r libraries}
# remotes::install_github('htmlwidgets/sparkline')

library(readr)
library(tidyverse)
library(ggplot2)
library(plotly)
library(lubridate)
library(sparkline)
library(DT)
library(formattable)
library(scales)

data <- readr::read_csv('https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data.csv') %>% 
               filter(location == "Peru")
```

```{r}
peru <- data %>% select(location, date, new_cases, positive_rate, new_deaths, new_tests,
                        new_vaccinations, people_vaccinated, people_fully_vaccinated) %>%
  mutate(date = ymd(date),
         day = day(date),
         month = month(date),
         year = year(date))
```

![ ](pics/peru.png)

<html>
<head>
<style>

h2 {
  color: black;
  padding: 15px;
}


p {
  font-family: verdana;
}

</style>
</head>
<body>


<h2>Introduction</h2>
<p> Into here </p>

<h3>Data Description</h3>
<p> DD here </p>

<h3>Data Story</h3>
<p> DS here </p>

</body>
</html>


## Economic-Pandemic
```{r}
tab1<-  peru %>%
  mutate(quaters = quarter(date, with_year = TRUE)) %>% 
  group_by(quaters) %>%
  summarise("Tests" = sum(new_tests, na.rm = TRUE),
            "Positive Cases" = sum(new_cases, na.rm = TRUE),
            "Deaths" = sum(new_deaths, na.rm = TRUE)) %>%
  pivot_longer(cols = -quaters,
               names_to = "Variables",
               values_to = "value")%>%
  pivot_wider(names_from = Variables,
              values_from = value) %>%
  rename(Quaters = quaters)

   tab1 %>% 
  select(Quaters, Tests, 'Positive Cases', Deaths) %>% 
  as.data.frame() %>%  
  formattable(list(area(col = 4) ~ color_tile( "#3CB371", "#CD5C5C"))) #Higher value and Lower value

```
explain 1st table


## Vaccination Impacts

```{r}

peru %>%
  group_by(month) %>% filter(year == 2021) %>%
  mutate(month = month(date, label = TRUE)) %>%
  summarise("Vaccination" = sum(new_vaccinations, na.rm = TRUE),
            "Timeline" = spk_chr(new_vaccinations, type ="line"),
            "Partially Vaccinated" = sum(people_vaccinated, na.rm = TRUE),
            "Fully Vaccinated" = sum(people_fully_vaccinated, na.rm = TRUE),
            "Distribution" = spk_chr(people_fully_vaccinated, type ="box"))%>%
  rename(Month = month)%>%
  datatable(escape = FALSE, 
            ,caption = htmltools::tags$caption( style = 'caption-side: top; 
                                                text-align: center;  color:black; font-size:120% ;',
                                                'Vaccination Rate 2021'),
            options = c (list(pageLength = 10 ))) %>%
  spk_add_deps()


```

explain 2nd table